                <!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Professional Data Entry — Sheet & Export Tool</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724; --panel:#061025; --card:#071229; --accent:#06b6d4; --accent-2:#7c3aed; --muted:#94a3b8; --glass:rgba(255,255,255,0.03);
      --surface:#071026; --success:#10b981; --danger:#ef4444;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    body{margin:0;background:linear-gradient(180deg,#041022 0%,#02101a 100%);color:#e6eef6;padding:28px}
    .wrap{max-width:1200px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:white}
    h1{margin:0;font-size:20px;font-weight:700}
    p.lead{margin:0;color:var(--muted);font-size:13px}.grid{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:20px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:16px;box-shadow:0 10px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.02)}

label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
input,select,textarea{width:100%;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit}
input[type=file]{padding:6px}
button{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;padding:9px 14px;border-radius:10px;color:white;cursor:pointer;font-weight:600}
.muted{color:var(--muted)}

.toolbar{display:flex;gap:8px;margin-bottom:10px}
.preview{min-height:220px;border-radius:10px;padding:12px;background:rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.02);overflow:auto}

table{width:100%;border-collapse:collapse;font-size:14px}
thead th{position:sticky;top:0;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));backdrop-filter:blur(6px);z-index:2;padding:10px;text-align:left}
th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.02)}
tbody tr:nth-child(even){background:linear-gradient(90deg, rgba(255,255,255,0.01), transparent)}
img.thumb{max-height:40px;border-radius:6px}

.controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.right-note{font-size:13px;color:var(--muted)}
.row-actions{display:flex;gap:6px}

.calc-panel{display:flex;gap:8px;align-items:center;margin-top:10px}
.pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-size:13px}

.footer{margin-top:16px;color:var(--muted);font-size:13px}

/* Responsive */
@media (max-width:980px){.grid{grid-template-columns:1fr}}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">D</div>
        <div>
          <h1>Professional Data Entry</h1>
          <p class="lead">Collect, style, calculate and export — designed for fast, expert-like data entry.</p>
        </div>
      </div>
      <div style="text-align:right">
        <div class="pill">Quick: All client-side — no server required</div>
      </div>
    </header><div class="grid">
  <section class="card">
    <h3 style="margin:0 0 10px 0">1) Enter your data</h3>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <div>
        <label>Name / Text</label>
        <input id="txtName" placeholder="e.g. John Doe" />
      </div>
      <div>
        <label>Number</label>
        <input id="numAge" type="number" placeholder="Numeric value" />
      </div>
      <div>
        <label>Date / Time</label>
        <input id="dt" type="datetime-local" />
      </div>
      <div>
        <label>Choice / Category</label>
        <select id="sel">
          <option value="A">Option A</option>
          <option value="B">Option B</option>
          <option value="C">Option C</option>
        </select>
      </div>
      <div style="grid-column:1 / -1">
        <label>Details / Notes</label>
        <textarea id="notes" rows="3" placeholder="Any notes..."></textarea>
      </div>
      <div>
        <label>Image (preview)</label>
        <input id="imgFile" type="file" accept="image/*" />
      </div>
      <div>
        <label>Tag / Label</label>
        <input id="tag" placeholder="Optional label e.g. "Project X"" />
      </div>
    </div>

    <div class="actions">
      <button id="btnAdd">Add to Sheet</button>
      <button id="btnClear">Clear</button>
      <div class="right-note">Tip: Add multiple rows to build your sheet. Use the editor on the right to create professional headers/notes.</div>
    </div>

    <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.02)" />

    <h3 style="margin:0 0 10px 0">2) Sheet (editable & calculations)</h3>
    <div id="tableWrap" class="preview">
      <table id="dataTable">
        <thead>
          <tr><th>#</th><th>Name</th><th>Number</th><th>Date/Time</th><th>Choice</th><th>Notes</th><th>Tag</th><th>Image</th><th>Actions</th></tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr><td colspan="9" id="summaryRow" style="text-align:right;color:var(--muted);padding:12px">No calculations yet.</td></tr>
        </tfoot>
      </table>
    </div>

    <div class="calc-panel">
      <label class="muted">Select numeric column:</label>
      <select id="numericColumn">
        <option value="num">Number</option>
      </select>
      <button id="btnSum">Sum</button>
      <button id="btnAvg">Average</button>
      <button id="btnProduct">Product</button>
      <button id="btnClearCalc">Clear Calc</button>
      <div id="calcResult" style="margin-left:auto;color:var(--accent);font-weight:700"></div>
    </div>

    <div class="controls">
      <button id="btnExportCSV">Download CSV</button>
      <button id="btnExportJSON">Download JSON</button>
      <button id="btnExportXLS">Download Excel (.xls)</button>
      <button id="btnDownloadHTML">Download Snapshot (HTML)</button>
      <button id="btnImportCSV">Import CSV</button>
      <input id="csvFile" type="file" accept="text/csv" style="display:none" />
    </div>

    <div class="footer">Works offline. CSV opens in Excel/Sheets. Images are embedded as data-URLs in the HTML snapshot.</div>
  </section>

  <aside class="card">
    <h3 style="margin-top:0">Live content editor — make a professional sheet</h3>
    <div class="toolbar">
      <button data-cmd="bold">B</button>
      <button data-cmd="italic">I</button>
      <button data-cmd="underline">U</button>
      <button data-cmd="h1">H1</button>
      <button data-cmd="p">P</button>
    </div>
    <div id="editor" class="preview" contenteditable="true">Insert title, instructions, or a report header here. Style it and download with the button below.</div>

    <div style="margin-top:12px;display:flex;gap:8px">
      <button id="btnExportEditorHTML">Download Header HTML</button>
      <button id="btnCopyHTML">Copy Header HTML</button>
    </div>

    <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.02)" />

    <h4 style="margin:6px 0">Load / Edit existing HTML</h4>
    <div class="file-input">
      <input id="loadHTMLFile" type="file" accept="text/html" />
      <div class="right-note">Load a template, edit in the editor, then export snapshot.</div>
    </div>

    <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.02)" />

    <h4 style="margin:6px 0">Quick calculator</h4>
    <div class="muted">Use the sheet calculator to compute sums, averages or product across a numeric column.</div>
  </aside>
</div>

  </div>  <script>
    // In-memory rows
    const rows = [];
    const dataTableBody = document.querySelector('#dataTable tbody');
    const numericSelect = document.getElementById('numericColumn');

    // image reader
    function readImageAsDataURL(file){
      return new Promise((res,rej)=>{
        if(!file) return res('');
        const r=new FileReader(); r.onload=e=>res(e.target.result); r.onerror=rej; r.readAsDataURL(file);
      })
    }

    // Add row
    async function addRowFromForm(){
      const name=document.getElementById('txtName').value.trim();
      const num=document.getElementById('numAge').value;
      const dt=document.getElementById('dt').value;
      const sel=document.getElementById('sel').value;
      const notes=document.getElementById('notes').value;
      const tag=document.getElementById('tag').value;
      const inputFile=document.getElementById('imgFile');
      const img = inputFile.files[0] ? await readImageAsDataURL(inputFile.files[0]) : '';
      const row={name,num: num===''? '' : Number(num),dt,sel,notes,tag,img};
      rows.push(row); renderTable(); updateNumericColumns();
    }

    function escapeHtml(s=''){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;') }

    function renderTable(){
      dataTableBody.innerHTML='';
      rows.forEach((r,i)=>{
        const tr=document.createElement('tr');
        tr.innerHTML = `\
          <td>${i+1}</td>\
          <td contenteditable='true' data-key='name'>${escapeHtml(r.name)}</td>\
          <td contenteditable='true' data-key='num'>${r.num !== '' ? escapeHtml(r.num) : ''}</td>\
          <td contenteditable='true' data-key='dt'>${escapeHtml(r.dt)}</td>\
          <td contenteditable='true' data-key='sel'>${escapeHtml(r.sel)}</td>\
          <td contenteditable='true' data-key='notes'>${escapeHtml(r.notes)}</td>\
          <td contenteditable='true' data-key='tag'>${escapeHtml(r.tag)}</td>\
          <td>${r.img ? `<img src="${r.img}" class="thumb" />` : ''}</td>\
          <td class='row-actions'><button data-action='remove' data-i='${i}'>Delete</button></td>`;
        dataTableBody.appendChild(tr);
      });
      document.getElementById('summaryRow').innerText = rows.length ? `${rows.length} rows — ready to calculate.` : 'No calculations yet.';
    }

    // Form actions
    document.getElementById('btnAdd').addEventListener('click', async ()=>{ await addRowFromForm(); clearForm(); });
    document.getElementById('btnClear').addEventListener('click', clearForm);
    function clearForm(){ document.getElementById('txtName').value='';document.getElementById('numAge').value='';document.getElementById('dt').value='';document.getElementById('notes').value='';document.getElementById('imgFile').value=null;document.getElementById('tag').value=''}

    // Row delete
    dataTableBody.addEventListener('click', (e)=>{
      const btn=e.target.closest('button'); if(!btn) return;
      if(btn.dataset.action==='remove'){ const i=+btn.dataset.i; rows.splice(i,1); renderTable(); updateNumericColumns(); }
    });

    // Save edits in table to rows object when user changes contenteditable cells
    dataTableBody.addEventListener('input', (e)=>{
      const td = e.target.closest('td'); if(!td) return; const tr = td.parentElement; const idx = Array.from(dataTableBody.children).indexOf(tr);
      const key = e.target.dataset.key; if(!key) return; let val = e.target.innerText;
      if(key==='num'){ val = val.trim() === '' ? '' : Number(val); }
      rows[idx][key]=val;
    });

    // Exports / downloads
    function download(filename, content, mime='text/csv'){ const blob=new Blob([content],{type:mime}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); }

    function tableToCSV(){
      const header=['#','Name','Number','DateTime','Choice','Notes','Tag','ImageDataURL'];
      const lines=[header.join(',')];
      rows.forEach((r,i)=>{
        const esc=v=>`"${String(v??'').replace(/"/g,'""')}"`;
        lines.push([i+1,esc(r.name),esc(r.num),esc(r.dt),esc(r.sel),esc(r.notes),esc(r.tag),esc(r.img)].join(','));
      });
      return lines.join('
');
    }

    document.getElementById('btnExportCSV').addEventListener('click', ()=>{ const csv=tableToCSV(); download('sheet.csv',csv,'text/csv'); });
    document.getElementById('btnExportJSON').addEventListener('click', ()=>{ const json=JSON.stringify(rows,null,2); download('sheet.json',json,'application/json'); });
    document.getElementById('btnExportXLS').addEventListener('click', ()=>{ const csv=tableToCSV(); const blob=new Blob([csv],{type:'application/vnd.ms-excel'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='sheet.xls'; a.click(); URL.revokeObjectURL(url); });

    document.getElementById('btnDownloadHTML').addEventListener('click', ()=>{
      const editorHTML=document.getElementById('editor').innerHTML;
      const tableHTML=document.getElementById('dataTable').outerHTML;
      const full=`<!doctype html><html><head><meta charset="utf-8"><title>sheet-snapshot</title></head><body style="font-family:Inter,Arial">${editorHTML}<hr>${tableHTML}</body></html>`;
      download('sheet-snapshot.html',full,'text/html');
    });

    // Import CSV to rows
    document.getElementById('btnImportCSV').addEventListener('click', ()=>document.getElementById('csvFile').click());
    document.getElementById('csvFile').addEventListener('change', async (e)=>{
      const f=e.target.files[0]; if(!f) return; const txt=await f.text(); parseCSVToRows(txt); renderTable(); updateNumericColumns();
    });

    function parseCSVToRows(csv){
      try{
        const lines=csv.split(/
?
/).filter(Boolean);
        const dataLines=lines.slice(1); // skip header
        rows.length=0;
        dataLines.forEach(line=>{
          const parts = line.match(/("[^"]*"|[^,]+)/g) || [];
          const clean = parts.map(p=>p.replace(/^"|"$/g,'').replace(/""/g,'"'));
          const [,name,num,dt,sel,notes,tag,img] = clean;
          rows.push({name,num:num===''? '': Number(num),dt,sel,notes,tag,img});
        });
      }catch(e){ alert('CSV parse failed: '+e.message) }
    }

    // Editor controls
    document.querySelectorAll('.toolbar button').forEach(b=>{
      b.addEventListener('click', ()=>{
        const cmd=b.dataset.cmd;
        if(cmd==='h1') document.execCommand('formatBlock', false, 'h1');
        else if(cmd==='p') document.execCommand('formatBlock', false, 'p');
        else document.execCommand(cmd,false,null);
      });
    });

    document.getElementById('btnExportEditorHTML').addEventListener('click', ()=>{
      const html=document.getElementById('editor').innerHTML;
      const full='<!doctype html><html><head><meta charset="utf-8"><title>header</title></head><body>'+html+'</body></html>';
      download('header.html',full,'text/html');
    });
    document.getElementById('btnCopyHTML').addEventListener('click', ()=>{ navigator.clipboard.writeText(document.getElementById('editor').innerHTML).then(()=>alert('Header HTML copied to clipboard')) });

    document.getElementById('loadHTMLFile').addEventListener('change', async (e)=>{ const f=e.target.files[0]; if(!f) return; const txt=await f.text(); document.getElementById('editor').innerHTML = txt; e.target.value=null; });

    // Calculations
    function getColumnNumbers(key){ return rows.map(r=>{ const v=r[key]; return (v==='' || v==null || isNaN(Number(v)))? null : Number(v); }).filter(v=>v!==null); }
    document.getElementById('btnSum').addEventListener('click', ()=>{ const key=numericSelect.value; const nums=getColumnNumbers(key); const sum = nums.reduce((s,n)=>s+n,0); showCalc(`Sum = ${sum}`); });
    document.getElementById('btnAvg').addEventListener('click', ()=>{ const key=numericSelect.value; const nums=getColumnNumbers(key); const avg = nums.length ? (nums.reduce((s,n)=>s+n,0)/nums.length).toFixed(2) : 0; showCalc(`Average = ${avg}`); });
    document.getElementById('btnProduct').addEventListener('click', ()=>{ const key=numericSelect.value; const nums=getColumnNumbers(key); const product = nums.length ? nums.reduce((p,n)=>p*n,1) : 0; showCalc(`Product = ${product}`); });
    document.getElementById('btnClearCalc').addEventListener('click', ()=>{ showCalc(''); document.getElementById('summaryRow').innerText = rows.length ? `${rows.length} rows — ready to calculate.` : 'No calculations yet.' });
    function showCalc(text){ document.getElementById('calcResult').innerText=text; document.getElementById('summaryRow').innerText = text || (rows.length ? `${rows.length} rows — ready to calculate.` : 'No calculations yet.'); }

    function updateNumericColumns(){ // populate numeric column selector from table keys (simple)
      // For now keep 'num' mapped to Number column
      // placeholder for dynamic detection
    }

    // init demo
    rows.push({name:'Ali Khan',num:27,dt:'2025-09-04T10:00',sel:'A',notes:'Example row',tag:'demo',img:''}); renderTable(); updateNumericColumns();

  </script></body>
      </html>
